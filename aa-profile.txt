# AppArmor profile for SSH honeypot
#include <tunables/global>

profile ssh_honeypot /usr/bin/python3 flags=(attach_disconnected) {

    # Allow Python binary to execute
    /usr/bin/python3 mr,

    # Allow Python standard libraries and dynamic linking
    /lib/** r,
    /lib/x86_64-linux-gnu/** r,
    /usr/lib/** r,
    /usr/lib/x86_64-linux-gnu/** r,
    /usr/lib64/** r,
    /lib/ld-linux-x86-64.so.2 mr,
    /etc/ld.so.cache r,
    
    # Allow your honeypot directory
    /home/yns/Desktop/honeypoy-ssh/** mrw,  

    # Log file
    /home/yns/Desktop/honeypoy-ssh/ssh_logs.log rw,

    # SSH private key
    /home/yns/Desktop/honeypoy-ssh/key r,

    # Network access
    network inet stream,

    # Memory mapping and threading support
    capability sys_chroot,          # optional
    capability setuid,              # optional if using setuid exec
    /dev/urandom r,
    /dev/null rw,
    
    # Deny everything else
    deny /** wklx,
}
